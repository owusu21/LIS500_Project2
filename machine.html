<!DOCTYPE html>
<html>
<head>
  <meta charset = "UTF-8">
  <title>Our Machine</title>

  <!-- Font: Monsterrat -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

  <!-- Stylepage link -->
  <link rel="stylesheet" href="css/stylepage.css">

  <!-- Load p5.js and ml5.js libraries -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>
</head>

<!-- Navigation -->
  <header>
    <div class="nav-links">
      <a href="index.html">Home</a>
      <a href="resources.html">Implicit Bias Resources</a>
      <a href="tech-hero.html">Our Tech Heroes</a>
    </div>
    </header>
  
  <body>
    <h2>Our Machine Project</h2>
    <h3>What is Machine Learning</h3>
        <p>Machine learning is a field of Artifical Intelligence that allows computers to learn from data without being explicitly programmed. By feeding the computer data, the computer learns to identify patterns and make predictions or decision based on that data.</p>
    <h3>Project Statement</h3>
    <p>inset project statement here</p>
    <h3>Our Project</h3>
        <p>We decided to create a machine that would be able to identify if an image is either a horse, bird, or fish.</p>
    <h3>Project Scope</h3>
        <p>To train the machine, we used 13 different free use images showing a horse, 13 showing a fish, and 22 showing a bird. Here are some examples we used: </p>
    <img src="./assets/images/bird.jpg" alt="An image of a puffin, a type of bird, sitting on a rock">
                          <img src="./assets/images/fish.jpg" alt="An image of a orange fish in a body of water">
                          <img src="./assets/images/horse.jpg" alt="An image of a horse in a field">
        <p> We kept our sample of images relatively small in order to use images of horses, birds, and fish that we would be familiar with. </p>
<h3>The Process</h3>
    <p>Training the machine was relatviely simple after following the machine learning materials provided in our course. After uploading the images to our machine and cateogrizing them as horses, fish, or birds, we tested our machine. The machine works by utilizing a webcamera, and holding an image infront of it. We used our mobile phones to display an image for the webcamera to capture. Once caputered, the machine categorized the image.</p>
<h3>Watch Our Model</h3>
    <!---LINKED TO VIDEO-->

<h3>Try Our Model</h3>
<div id="model-container">
  <p>Hold up an image of a horse, bird, or fish to your webcam:</p>
  <button type="button" class="webcam-btn" onclick="init()">Start Webcam</button>
  <div id="webcam-container"></div>
  <div id="label-container"></div>
</div>

<h3>Check Out The Code</h3>
  <!--github link-->

  <script>
    // Your Teachable Machine model URL
    const URL = "https://teachablemachine.withgoogle.com/models/jRAbVev-M/";
    
    let model, webcam, labelContainer, maxPredictions;

    // Load the image model and setup the webcam
    async function init() {
      const modelURL = URL + "model.json";
      const metadataURL = URL + "metadata.json";

      // Hide the button after clicking
      document.querySelector('.webcam-btn').style.display = 'none';
      
      // Show loading message
      labelContainer = document.getElementById("label-container");
      labelContainer.innerHTML = "<div>Loading model...</div>";

      // Load the model and metadata
      model = await tmImage.load(modelURL, metadataURL);
      maxPredictions = model.getTotalClasses();

      // Setup webcam
      const flip = true; // whether to flip the webcam
      webcam = new tmImage.Webcam(400, 400, flip); // width, height, flip
      await webcam.setup(); // request access to the webcam
      await webcam.play();
      
      // Append webcam to container
      document.getElementById("webcam-container").appendChild(webcam.canvas);
      
      // Update loading message
      labelContainer.innerHTML = "";
      for (let i = 0; i < maxPredictions; i++) {
        labelContainer.appendChild(document.createElement("div"));
      }
      
      // Start prediction loop
      window.requestAnimationFrame(loop);
    }

    async function loop() {
      webcam.update(); // update the webcam frame
      await predict();
      window.requestAnimationFrame(loop);
    }

    // Run the webcam image through the image model
    async function predict() {
      // Predict can take in an image, video or canvas html element
      const prediction = await model.predict(webcam.canvas);
      for (let i = 0; i < maxPredictions; i++) {
        const classPrediction =
          prediction[i].className + ": " + 
          (prediction[i].probability * 100).toFixed(2) + "%";
        labelContainer.childNodes[i].innerHTML = classPrediction;
      }
    }
  </script>

</body>
</html>